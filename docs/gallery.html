<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galerie</title>

    <link rel="stylesheet" href="styles.css">

    <script defer src="darkmode.js"></script>
    <script defer src="viewer.js"></script>

</head>
<body>

<header>
    <h1>Gallery</h1>
    <nav>
        <a href="index.html">Start</a>
        <a href="plots.html">Plots</a>
        <a href="leaderboard.html">Leaderboard</a>
        <button id="darkToggle">ðŸŒ™</button>
    </nav>
</header>

<main>
    <div class="search-container">
        <input type="text" id="searchInput" placeholder="Suche nach Beys">
    </div>
    <div id="gallery" class="gallery"></div>
</main>

<footer>
    <p>Â© 2025 suptower</p>
</footer>

<script>
const paths = {
    bars: "./plots/bars/plots.json",
    elo: "./plots/elo/plots.json",
    positions: "./plots/positions/plots.json",
    heatmaps: "./plots/heatmaps/plots.json",
    single: "./plots/plots.json"
};

const titles = {
    bars: "Winrate & ELO Balkendiagramme",
    elo: "ELO-VerlÃ¤ufe",
    positions: "PositionsverlÃ¤ufe",
    heatmaps: "Heatmaps",
    single: "Kombinierte Plots"
};

const params = new URLSearchParams(window.location.search);
const type = params.get("type") || "single";

// only show search bar for position and elo
document.addEventListener("DOMContentLoaded", () => {
    if (type === "elo" || type === "positions") {
        document.querySelector(".search-container").style.display = "block";
    } else {
        document.querySelector(".search-container").style.display = "none";
    }
});

const titleElem = document.getElementById("title");
if (titleElem) {
    titleElem.textContent = titles[type];
}


let allImages = [];
let currentImages = [];

fetch(paths[type])
    .then(res => res.json())
    .then(files => {
        const base = paths[type].replace("plots.json", "");
        
        allImages = files.map(f => ({
            src: base + f,
            title: f.replace(/\.(png|jpg|jpeg)$/i, '').replace(/_position$/i, '')
        }));
        
        currentImages = [...allImages];
        renderGallery(currentImages);
        
        // Setup search
        const searchInput = document.getElementById("searchInput");
        searchInput.addEventListener("input", e => {
            const query = e.target.value.toLowerCase();
            currentImages = allImages.filter(img => 
                img.title.toLowerCase().includes(query)
            );
            renderGallery(currentImages);
        });
    });

function renderGallery(images) {
    const gallery = document.getElementById("gallery");
    gallery.innerHTML = "";
    
    images.forEach((imgObj, index) => {
        const img = document.createElement("img");
        img.src = imgObj.src;
        img.alt = imgObj.title;
        img.onclick = () => openViewer(index, currentImages);
        gallery.appendChild(img);
    });
}
</script>

</body>
</html>
