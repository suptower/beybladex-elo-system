<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meta Landscape - Beyblade X</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }
        body.light {
            background-color: #ffffff;
            color: #1a1a1a;
        }
        body.dark {
            background-color: #0f172a;
            color: #f1f5f9;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 10px;
        }
        .header h1 {
            margin: 0;
            font-size: 1.5em;
        }
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .theme-toggle label {
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border-radius: 20px;
            transition: background-color 0.3s;
        }
        body.light .theme-toggle label {
            background-color: #e5e7eb;
        }
        body.dark .theme-toggle label {
            background-color: #334155;
        }
        .theme-toggle input {
            display: none;
        }
        .theme-icon {
            font-size: 1.2em;
        }
        .back-link {
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 8px;
            transition: background-color 0.3s;
        }
        body.light .back-link {
            color: #1a1a1a;
            background-color: #e5e7eb;
        }
        body.dark .back-link {
            color: #f1f5f9;
            background-color: #334155;
        }
        .back-link:hover {
            opacity: 0.8;
        }
        #plotDiv {
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
        }
        /* Mobile responsive styles */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                flex-wrap: wrap;
            }
            .header h1 {
                font-size: 1.2em;
                order: -1;
                width: 100%;
                text-align: center;
            }
            .back-link {
                padding: 6px 12px;
                font-size: 0.9em;
            }
            .theme-toggle {
                width: 100%;
                justify-content: center;
            }
            .theme-toggle label {
                padding: 6px 12px;
                font-size: 0.9em;
            }
            #plotDiv {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1em;
            }
        }
    </style>
</head>
<body class="light">
    <div class="header">
        <a href="../plots.html" class="back-link">‚Üê Back to Plots</a>
        <h1>üó∫Ô∏è Meta Landscape</h1>
        <div class="theme-toggle">
            <label>
                <input type="checkbox" id="themeToggle">
                <span class="theme-icon" id="themeIcon">üåô</span>
                <span id="themeLabel">Dark Mode</span>
            </label>
        </div>
    </div>
    <div id="plotDiv"></div>

    <script>
        // Data
        const xData = [1.87, 1.81, 2.03, 1.95, 1.39, 1.74, 1.97, 1.79, 2.21, 1.81, 1.28, 1.39, 1.61, 1.88, 2.17, 2.12, 1.11, 1.75, 2.5, 0.88, 1.8, 1.45, 1.58, 0.75, 1.47, 2.12, 1.92, 1.29, 0.0, 1.83, 1.75, 1.12, 1.75, 1.75, 2.75, 0.5];
        const yData = [3.7, 3.94, 4.31, 3.78, 3.75, 3.62, 3.91, 3.42, 4.0, 3.68, 3.84, 3.83, 3.0, 3.62, 3.5, 3.72, 3.0, 3.85, 3.12, 3.3, 3.46, 3.92, 4.0, 4.25, 3.42, 4.0, 3.69, 3.3, 3.62, 3.46, 3.81, 4.29, 4.0, 3.75, 3.5, 3.96];
        const textData = ["FoxBrush", "ImpactDrake", "CerberusFlame", "CobaltDragoon", "KnightMail", "TuskMammoth", "DranDagger", "RhinoReaper", "WeissTiger", "UnicornSting", "ViperTail", "DranSword", "SilverWolf", "WizardRod", "DranBuster", "HellsChain", "GolemRock", "WizardArrow", "WhaleFlame", "PerseusDark", "ScorpioSpear", "PhoenixRudder", "LeonCrest", "WizardArc", "TyrannoBeat", "HellsReaper", "PhoenixWing", "SharkEdge", "PegasusBlast", "DranBrave", "LeonClaw", "HellsHammer", "BlackShell", "WhaleWave", "SamuraiSaber", "CrimsonGaruda"];
        const eloData = [1076, 1064, 1033, 1029, 1022, 1022, 1022, 1021, 1017, 1005, 1004, 1002, 1000, 999, 996, 995, 994, 993, 992, 992, 992, 991, 991, 989, 987, 987, 985, 985, 982, 981, 978, 978, 978, 977, 973, 968];
        const markerSizes = [40.0, 33.33333333333333, 20.0, 23.333333333333332, 16.666666666666664, 30.0, 23.333333333333332, 26.666666666666668, 16.666666666666664, 23.333333333333332, 20.0, 23.333333333333332, 20.0, 23.333333333333332, 16.666666666666664, 16.666666666666664, 20.0, 13.333333333333332, 10.0, 16.666666666666664, 20.0, 20.0, 13.333333333333332, 13.333333333333332, 16.666666666666664, 13.333333333333332, 20.0, 16.666666666666664, 10.0, 16.666666666666664, 13.333333333333332, 13.333333333333332, 16.666666666666664, 16.666666666666664, 13.333333333333332, 13.333333333333332];
        const hoverText = ["<b>FoxBrush</b><br>Rank: #1<br>ELO: 1076<br>Winrate: 90.0%<br>Matches: 10<br><br>Offense: 1.87<br>Defense: 3.70<br><br><i>Click for Bey profile</i>", "<b>ImpactDrake</b><br>Rank: #2<br>ELO: 1064<br>Winrate: 87.5%<br>Matches: 8<br><br>Offense: 1.81<br>Defense: 3.94<br><br><i>Click for Bey profile</i>", "<b>CerberusFlame</b><br>Rank: #3<br>ELO: 1033<br>Winrate: 75.0%<br>Matches: 4<br><br>Offense: 2.03<br>Defense: 4.31<br><br><i>Click for Bey profile</i>", "<b>CobaltDragoon</b><br>Rank: #4<br>ELO: 1029<br>Winrate: 60.0%<br>Matches: 5<br><br>Offense: 1.95<br>Defense: 3.78<br><br><i>Click for Bey profile</i>", "<b>KnightMail</b><br>Rank: #5<br>ELO: 1022<br>Winrate: 66.7%<br>Matches: 3<br><br>Offense: 1.39<br>Defense: 3.75<br><br><i>Click for Bey profile</i>", "<b>TuskMammoth</b><br>Rank: #6<br>ELO: 1022<br>Winrate: 71.4%<br>Matches: 7<br><br>Offense: 1.74<br>Defense: 3.62<br><br><i>Click for Bey profile</i>", "<b>DranDagger</b><br>Rank: #7<br>ELO: 1022<br>Winrate: 60.0%<br>Matches: 5<br><br>Offense: 1.97<br>Defense: 3.91<br><br><i>Click for Bey profile</i>", "<b>RhinoReaper</b><br>Rank: #8<br>ELO: 1021<br>Winrate: 66.7%<br>Matches: 6<br><br>Offense: 1.79<br>Defense: 3.42<br><br><i>Click for Bey profile</i>", "<b>WeissTiger</b><br>Rank: #9<br>ELO: 1017<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 2.21<br>Defense: 4.00<br><br><i>Click for Bey profile</i>", "<b>UnicornSting</b><br>Rank: #10<br>ELO: 1005<br>Winrate: 60.0%<br>Matches: 5<br><br>Offense: 1.81<br>Defense: 3.68<br><br><i>Click for Bey profile</i>", "<b>ViperTail</b><br>Rank: #11<br>ELO: 1004<br>Winrate: 50.0%<br>Matches: 4<br><br>Offense: 1.28<br>Defense: 3.84<br><br><i>Click for Bey profile</i>", "<b>DranSword</b><br>Rank: #12<br>ELO: 1002<br>Winrate: 60.0%<br>Matches: 5<br><br>Offense: 1.39<br>Defense: 3.83<br><br><i>Click for Bey profile</i>", "<b>SilverWolf</b><br>Rank: #13<br>ELO: 1000<br>Winrate: 50.0%<br>Matches: 4<br><br>Offense: 1.61<br>Defense: 3.00<br><br><i>Click for Bey profile</i>", "<b>WizardRod</b><br>Rank: #14<br>ELO: 999<br>Winrate: 60.0%<br>Matches: 5<br><br>Offense: 1.88<br>Defense: 3.62<br><br><i>Click for Bey profile</i>", "<b>DranBuster</b><br>Rank: #15<br>ELO: 996<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 2.17<br>Defense: 3.50<br><br><i>Click for Bey profile</i>", "<b>HellsChain</b><br>Rank: #16<br>ELO: 995<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 2.12<br>Defense: 3.72<br><br><i>Click for Bey profile</i>", "<b>GolemRock</b><br>Rank: #17<br>ELO: 994<br>Winrate: 50.0%<br>Matches: 4<br><br>Offense: 1.11<br>Defense: 3.00<br><br><i>Click for Bey profile</i>", "<b>WizardArrow</b><br>Rank: #18<br>ELO: 993<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 1.75<br>Defense: 3.85<br><br><i>Click for Bey profile</i>", "<b>WhaleFlame</b><br>Rank: #19<br>ELO: 992<br>Winrate: 0.0%<br>Matches: 1<br><br>Offense: 2.50<br>Defense: 3.12<br><br><i>Click for Bey profile</i>", "<b>PerseusDark</b><br>Rank: #20<br>ELO: 992<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 0.88<br>Defense: 3.30<br><br><i>Click for Bey profile</i>", "<b>ScorpioSpear</b><br>Rank: #21<br>ELO: 992<br>Winrate: 50.0%<br>Matches: 4<br><br>Offense: 1.80<br>Defense: 3.46<br><br><i>Click for Bey profile</i>", "<b>PhoenixRudder</b><br>Rank: #22<br>ELO: 991<br>Winrate: 50.0%<br>Matches: 4<br><br>Offense: 1.45<br>Defense: 3.92<br><br><i>Click for Bey profile</i>", "<b>LeonCrest</b><br>Rank: #23<br>ELO: 991<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 1.58<br>Defense: 4.00<br><br><i>Click for Bey profile</i>", "<b>WizardArc</b><br>Rank: #24<br>ELO: 989<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 0.75<br>Defense: 4.25<br><br><i>Click for Bey profile</i>", "<b>TyrannoBeat</b><br>Rank: #25<br>ELO: 987<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 1.47<br>Defense: 3.42<br><br><i>Click for Bey profile</i>", "<b>HellsReaper</b><br>Rank: #26<br>ELO: 987<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 2.12<br>Defense: 4.00<br><br><i>Click for Bey profile</i>", "<b>PhoenixWing</b><br>Rank: #27<br>ELO: 985<br>Winrate: 50.0%<br>Matches: 4<br><br>Offense: 1.92<br>Defense: 3.69<br><br><i>Click for Bey profile</i>", "<b>SharkEdge</b><br>Rank: #28<br>ELO: 985<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 1.29<br>Defense: 3.30<br><br><i>Click for Bey profile</i>", "<b>PegasusBlast</b><br>Rank: #29<br>ELO: 982<br>Winrate: 0.0%<br>Matches: 1<br><br>Offense: 0.00<br>Defense: 3.62<br><br><i>Click for Bey profile</i>", "<b>DranBrave</b><br>Rank: #30<br>ELO: 981<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 1.83<br>Defense: 3.46<br><br><i>Click for Bey profile</i>", "<b>LeonClaw</b><br>Rank: #31<br>ELO: 978<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 1.75<br>Defense: 3.81<br><br><i>Click for Bey profile</i>", "<b>HellsHammer</b><br>Rank: #32<br>ELO: 978<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 1.12<br>Defense: 4.29<br><br><i>Click for Bey profile</i>", "<b>BlackShell</b><br>Rank: #33<br>ELO: 978<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 1.75<br>Defense: 4.00<br><br><i>Click for Bey profile</i>", "<b>WhaleWave</b><br>Rank: #34<br>ELO: 977<br>Winrate: 33.3%<br>Matches: 3<br><br>Offense: 1.75<br>Defense: 3.75<br><br><i>Click for Bey profile</i>", "<b>SamuraiSaber</b><br>Rank: #35<br>ELO: 973<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 2.75<br>Defense: 3.50<br><br><i>Click for Bey profile</i>", "<b>CrimsonGaruda</b><br>Rank: #36<br>ELO: 968<br>Winrate: 0.0%<br>Matches: 2<br><br>Offense: 0.50<br>Defense: 3.96<br><br><i>Click for Bey profile</i>"];

        // Responsive dimensions
        function getResponsiveDimensions() {
            const width = Math.min(window.innerWidth - 40, 1000);
            const height = window.innerWidth < 480 ? Math.min(width * 1.2, 500) : Math.min(width * 0.8, 800);
            return { width, height };
        }

        // Light mode layout
        function getLightLayout() {
            const dims = getResponsiveDimensions();
            const isMobile = window.innerWidth < 480;
            return {
            title: {
                text: isMobile ? 'Meta Landscape' : 'Meta Landscape: Offense vs Defense Map',
                font: { size: isMobile ? 14 : 18, color: '#1a1a1a' }
            },
            xaxis: {
                title: isMobile ? 'Offense ‚Üí' : 'Offense Score ‚Üí',
                range: [-0.2, 5.2],
                gridcolor: 'rgba(128,128,128,0.2)',
                color: '#1a1a1a'
            },
            yaxis: {
                title: isMobile ? 'Defense ‚Üí' : 'Defense Score ‚Üí',
                range: [-0.2, 5.2],
                gridcolor: 'rgba(128,128,128,0.2)',
                color: '#1a1a1a'
            },
            paper_bgcolor: '#ffffff',
            plot_bgcolor: '#ffffff',
            hovermode: 'closest',
            width: dims.width,
            height: dims.height,
            margin: isMobile ? { l: 40, r: 20, t: 50, b: 40 } : { l: 60, r: 30, t: 60, b: 50 },
            shapes: [
                { type: 'line', x0: -0.2, x1: 5.2, y0: 2.5, y1: 2.5, line: { dash: 'dash', color: 'gray', width: 1 }, opacity: 0.4 },
                { type: 'line', x0: 2.5, x1: 2.5, y0: -0.2, y1: 5.2, line: { dash: 'dash', color: 'gray', width: 1 }, opacity: 0.4 }
            ],
            annotations: isMobile ? [] : [
                { x: 4.5, y: 4.5, text: 'Balanced<br>(High Off/Def)', showarrow: false, font: { size: 10, color: 'rgba(0,0,0,0.3)' } },
                { x: 0.5, y: 4.5, text: 'Defensive<br>Specialist', showarrow: false, font: { size: 10, color: 'rgba(0,0,0,0.3)' } },
                { x: 4.5, y: 0.5, text: 'Offensive<br>Specialist', showarrow: false, font: { size: 10, color: 'rgba(0,0,0,0.3)' } },
                { x: 0.5, y: 0.5, text: 'Low Impact', showarrow: false, font: { size: 10, color: 'rgba(0,0,0,0.3)' } }
            ]
        };
        }

        // Dark mode layout
        function getDarkLayout() {
            const dims = getResponsiveDimensions();
            const isMobile = window.innerWidth < 480;
            return {
            title: {
                text: isMobile ? 'Meta Landscape' : 'Meta Landscape: Offense vs Defense Map',
                font: { size: isMobile ? 14 : 18, color: '#f1f5f9' }
            },
            xaxis: {
                title: isMobile ? 'Offense ‚Üí' : 'Offense Score ‚Üí',
                range: [-0.2, 5.2],
                gridcolor: 'rgba(128,128,128,0.2)',
                color: '#f1f5f9'
            },
            yaxis: {
                title: isMobile ? 'Defense ‚Üí' : 'Defense Score ‚Üí',
                range: [-0.2, 5.2],
                gridcolor: 'rgba(128,128,128,0.2)',
                color: '#f1f5f9'
            },
            paper_bgcolor: '#0f172a',
            plot_bgcolor: '#1e293b',
            hovermode: 'closest',
            width: dims.width,
            height: dims.height,
            margin: isMobile ? { l: 40, r: 20, t: 50, b: 40 } : { l: 60, r: 30, t: 60, b: 50 },
            shapes: [
                { type: 'line', x0: -0.2, x1: 5.2, y0: 2.5, y1: 2.5, line: { dash: 'dash', color: 'gray', width: 1 }, opacity: 0.4 },
                { type: 'line', x0: 2.5, x1: 2.5, y0: -0.2, y1: 5.2, line: { dash: 'dash', color: 'gray', width: 1 }, opacity: 0.4 }
            ],
            annotations: isMobile ? [] : [
                { x: 4.5, y: 4.5, text: 'Balanced<br>(High Off/Def)', showarrow: false, font: { size: 10, color: 'rgba(255,255,255,0.4)' } },
                { x: 0.5, y: 4.5, text: 'Defensive<br>Specialist', showarrow: false, font: { size: 10, color: 'rgba(255,255,255,0.4)' } },
                { x: 4.5, y: 0.5, text: 'Offensive<br>Specialist', showarrow: false, font: { size: 10, color: 'rgba(255,255,255,0.4)' } },
                { x: 0.5, y: 0.5, text: 'Low Impact', showarrow: false, font: { size: 10, color: 'rgba(255,255,255,0.4)' } }
            ]
        };
        }

        // Create trace function with theme-specific colors
        function createTrace(isDark) {
            const isMobile = window.innerWidth < 480;
            return {
                x: xData,
                y: yData,
                mode: isMobile ? 'markers' : 'markers+text',
                type: 'scatter',
                text: textData,
                textposition: 'top center',
                textfont: { size: isMobile ? 7 : 9, color: isDark ? '#f1f5f9' : '#1a1a1a' },
                marker: {
                    size: isMobile ? markerSizes.map(s => s * 0.6) : markerSizes,
                    color: eloData,
                    colorscale: 'RdYlGn',
                    colorbar: {
                        title: { text: 'ELO', font: { color: isDark ? '#f1f5f9' : '#1a1a1a' } },
                        thickness: isMobile ? 10 : 15,
                        len: isMobile ? 0.5 : 0.7,
                        tickfont: { color: isDark ? '#f1f5f9' : '#1a1a1a', size: isMobile ? 10 : 12 }
                    },
                    showscale: true,
                    line: { width: 1, color: isDark ? '#ffffff' : '#000000' }
                },
                hovertext: hoverText,
                hoverinfo: 'text'
            };
        }

        // Config
        const config = {
            displayModeBar: true,
            modeBarButtonsToAdd: ['pan2d', 'zoomIn2d', 'zoomOut2d', 'resetScale2d'],
            responsive: true
        };

        // Initialize plot
        let isDarkMode = localStorage.getItem('theme') === 'dark';
        const toggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themeLabel = document.getElementById('themeLabel');

        function updateTheme(isDark) {
            document.body.className = isDark ? 'dark' : 'light';
            themeIcon.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
            themeLabel.textContent = isDark ? 'Light Mode' : 'Dark Mode';
            toggle.checked = isDark;

            const layout = isDark ? getDarkLayout() : getLightLayout();
            const trace = createTrace(isDark);

            Plotly.react('plotDiv', [trace], layout, config);
        }

        // Set initial state
        updateTheme(isDarkMode);

        // Handle window resize for responsive plots
        let resizeTimeout;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimeout);
            resizeTimeout = setTimeout(function() {
                updateTheme(isDarkMode);
            }, 250);
        });

        // Handle toggle change
        toggle.addEventListener('change', function() {
            isDarkMode = this.checked;
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            updateTheme(isDarkMode);
        });

        // Listen for theme changes from other pages
        window.addEventListener('storage', function(e) {
            if (e.key === 'theme') {
                isDarkMode = e.newValue === 'dark';
                updateTheme(isDarkMode);
            }
        });
    </script>
</body>
</html>